# state_spec_Na_channel_blocker_modeling

Code for the manuscript, "Rate-dependent effects of state-specific sodium channel blockers in cardiac tissue: Insights from idealized models," published in Journal of Theoretical Biology in 2023

Notes:
	-Data from simulations using the ten Tusscher et al. model is obtained by running the C++ codes and some of these simulations may take a couple days and require parallel computing capabilities to not take longer.
	-For C++ codes, when switching between V-dependent and non-V-dependent k_off rates, need to change the k_off value in I_Na_Simple.h and the directory that results are saved to in Upstroke_rest_30s_all_models_mult_time_const.h, Upstroke_vs_period_all_models_mult_time_const.h, or Upstroke_all_models_mult_time_const_1freq.h (whichever is being run).

Figure Codes:
Figure 2:
Figures are generated using Upstroke_v_Period_3_tau_b.m.  The data is generated by the C++ programs Upstroke_vs_period_all_models_mult_time_const.h and Upstroke_rest_30s_all_models_mult_time_const.h, which calculate peak upstroke velocity for various BCL or after 30s rest, respectively, when modeling effect of the various drug binding schemes with the two model formulations.

Figure 3:
Figures are generated using Upstroke_vs_tau_b.m.  The data is generated by the C++ program Upstroke_all_models_mult_time_const_1freq.h.

Figure 4:
Generated by running b_Duty_cycle_h_infty.m, which calls HH_b_star.m and HH_analytic.m.  ten Tusscher results are generated using the APDs_all_HH_form.h code in the C++ folder.  

Figure 5:
Generated by running b_star_using_restitution_curve.m.  In addition to using the square wave approximation of the action potential to calculate b*, this code also uses the peak upstroke velocity data from the Upstroke_all_models_mult_time_const_1freq.h code.

Figure 6:
Generated by running b_steady_state_drug_models.m.

Figure 7:
Panel A is generated by CV_vs_BCL_output.m, which loads data from the CV_results_12_22_17 folder generated by the CV_vs_BCL_cable.h code in the 1D_modified_Ten_Tusscher_with_drug folder.  Panels B and C are created with the VW_plots code, which loads data from the VW_initialization_12_15_17 and VW_results_12_22_17 folders generated by the VW_initialization_cable.h, VW_find_VW_high_resolution_cable.h, and VW_find_VW_GRI_high_resolution_cable.h codes in the 1D_modified_Ten_Tusscher_with_drug program.

Figure 8:
Panel A is generated by b_star_non_V_dependent_using_restitution_curve.m, which loads data from Upstroke_vs_Period_nonVdepend_2_28_18, which was generated with the Upstroke_vs_period_all_models_mult_time_const.h code for k_on = 10M^-1ms^-1 and with k_off set to be non-V-dependent in I_Na_Simple.h and the output folder is changed.  The code also uses HH_b_star_neutral_drug.m.  Panel B is generated by b_steady_state_neutral_drug_models.m, which calls Model_Matrices_neutral_drug.m.

Supplemental Fig:
Figures generated by I_O_approx_dynamis_visualization.m.

SI Figure on restitution curve
Figure is generated using Upstroke_v_Period_3_tau_b.m and exported using paper16 settings.  The data is generated by the C++ programs Upstroke_vs_period_all_models_mult_time_const.h and Upstroke_rest_30s_all_models_mult_time_const.h.  Figure is called SFig3p1_restitution_curve.tif and is in the Figures folder.
